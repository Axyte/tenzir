"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2713],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=r.createContext({}),l=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(p.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,p=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),c=l(n),d=a,m=c["".concat(p,".").concat(d)]||c[d]||h[d]||i;return n?r.createElement(m,o(o({ref:t},u),{},{components:n})):r.createElement(m,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var p in t)hasOwnProperty.call(t,p)&&(s[p]=t[p]);s.originalType=e,s[c]="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},17078:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>f,contentTitle:()=>g,default:()=>w,frontMatter:()=>m,metadata:()=>b,toc:()=>k});var r=n(3905),a=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,u=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,c=(e,t)=>{for(var n in t||(t={}))p.call(t,n)&&u(e,n,t[n]);if(s)for(var n of s(t))l.call(t,n)&&u(e,n,t[n]);return e},h=(e,t)=>i(e,o(t)),d=(e,t)=>{var n={};for(var r in e)p.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&s)for(var r of s(e))t.indexOf(r)<0&&l.call(e,r)&&(n[r]=e[r]);return n};const m={},g="Plugins",b={unversionedId:"use/integrate/threatbus/understand/plugins/README",id:"version-VAST v3.1/use/integrate/threatbus/understand/plugins/README",title:"Plugins",description:"Threat Bus has a plugin-based architecture, implemented via",source:"@site/versioned_docs/version-VAST v3.1/use/integrate/threatbus/understand/plugins/README.md",sourceDirName:"use/integrate/threatbus/understand/plugins",slug:"/use/integrate/threatbus/understand/plugins/",permalink:"/use/integrate/threatbus/understand/plugins/",draft:!1,editUrl:"https://github.com/tenzir/tenzir/tree/main/web/versioned_docs/version-VAST v3.1/use/integrate/threatbus/understand/plugins/README.md",tags:[],version:"VAST v3.1",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Snapshotting",permalink:"/use/integrate/threatbus/understand/snapshotting"},next:{title:"MISP Plugin",permalink:"/use/integrate/threatbus/understand/plugins/apps/misp"}},f={},k=[{value:"Plugin Types",id:"plugin-types",level:2},{value:"Application Plugins",id:"application-plugins",level:3},{value:"Backbone Plugins",id:"backbone-plugins",level:3},{value:"Apps and Wrappers",id:"apps-and-wrappers",level:2}],y={toc:k},v="wrapper";function w(e){var t=e,{components:n}=t,a=d(t,["components"]);return(0,r.kt)(v,h(c(c({},y),a),{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",c({},{id:"plugins"}),"Plugins"),(0,r.kt)("p",null,"Threat Bus has a plugin-based architecture, implemented via\n",(0,r.kt)("a",c({parentName:"p"},{href:"https://pluggy.readthedocs.io/"}),"pluggy"),". The following document describes the\nexisting plugin types in detail and explains their responsibilities."),(0,r.kt)("h2",c({},{id:"plugin-types"}),"Plugin Types"),(0,r.kt)("p",null,"Threat Bus differentiates two plugin types. ",(0,r.kt)("strong",{parentName:"p"},"Application plugins"),' extend\nThreat Bus to provide a new endpoint for "apps" to connect with. How the\nendpoint looks like, and what message-formats are used for communication is up\nto the application plugin. "Apps" are security tools, like Zeek or VAST.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Backbone plugins")," are required for actual message\npassing. At least one backbone plugin is required for the bus to\nbe functional. The most basic plugin for that job is the\n",(0,r.kt)("a",c({parentName:"p"},{href:"plugins/backbones/in-mem"}),"in-memory backbone"),"."),(0,r.kt)("h3",c({},{id:"application-plugins"}),"Application Plugins"),(0,r.kt)("p",null,"Application plugins are the entrypoint for applications to connect with Threat\nBus. App plugins do two things:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"They provide an endpoint."),"\nApp plugins provide an endpoint (i.e., they bind certain ports) and offer a\ncommunication protocol. For example, the\n",(0,r.kt)("a",c({parentName:"li"},{href:"plugins/apps/zeek"}),"Zeek plugin")," exposes a\n",(0,r.kt)("a",c({parentName:"li"},{href:"https://github.com/zeek/broker"}),"Broker"),' endpoint. Broker is the native\ncommunication protocol for Zeek ("the app"), so it is the Zeek plugin\'s\nresponsibility to expose an endpoint that Zeek instances can work with.'),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("strong",{parentName:"li"},"They handle message-format mapping."),"\nThreat Bus internally uses the\n",(0,r.kt)("a",c({parentName:"li"},{href:"https://oasis-open.github.io/cti-documentation/stix/intro.html"}),"STIX-2"),"\nserialization format. Not all open-source security tools can work\nwith this format. App plugins can implement mappings from STIX-2 to other\nformats, so that connecting apps can work with it. For example, the MISP\nplugin receives a proprietary format from MISP and transforms these attribute\nto STIX-2 Indicators.")),(0,r.kt)("p",null,"Threat Bus itself is at no point concerned with alternative formats, nor with\ndetails about the connected applications, nor exposed endpoints.\nInstead, Threat Bus is only aware of ",(0,r.kt)("inlineCode",{parentName:"p"},"Subscribers")," and STIX-2 messages that are\nexchanged between them."),(0,r.kt)("h3",c({},{id:"backbone-plugins"}),"Backbone Plugins"),(0,r.kt)("p",null,"Backbone plugins either implement the message provisioning logic themselves\n(like the ",(0,r.kt)("a",c({parentName:"p"},{href:"plugins/backbones/in-mem"}),"in-memory backbone plugin"),") or\noffer a transparent interface to existing message brokers, like the\n",(0,r.kt)("a",c({parentName:"p"},{href:"plugins/backbones/rabbitmq"}),"RabbitMQ backbone plugin")," does."),(0,r.kt)("p",null,"Threat Bus notifies all backbone-plugins whenever new subscriptions come in.\nA subscription consists of a ",(0,r.kt)("inlineCode",{parentName:"p"},"topic")," and a queue (",(0,r.kt)("inlineCode",{parentName:"p"},"outq"),") that is used by the\nsubscriber to receive messages. The job of a backbone plugin is to read messages\nfrom the global queue of incoming messages (",(0,r.kt)("inlineCode",{parentName:"p"},"inq"),"), optionally hand these over\nto an existing messaging broker (like RabbitMQ) and consume them back, and\nlastly, based on the topic, sort those messages to all subscribed ",(0,r.kt)("inlineCode",{parentName:"p"},"outq"),"s."),(0,r.kt)("h2",c({},{id:"apps-and-wrappers"}),"Apps and Wrappers"),(0,r.kt)("p",null,"Threat Bus is a pub/sub broker, and hence applications have to subscribe\nthemselves to the bus. However, that requires active behavior from applications,\nand hence could require changes to the source code. Generally speaking, that is\nundesirable."),(0,r.kt)("p",null,"Some applications, like Zeek, can be scripted. In that particular case, the\nlogic for connecting to Threat Bus is implemented in a separate\n",(0,r.kt)("a",c({parentName:"p"},{href:"https://github.com/tenzir/threatbus/tree/master/apps/zeek"}),"script"),"."),(0,r.kt)("p",null,"Other applications, like VAST, cannot be scripted. Those applications require\neither a change to the source code or a wrapper script to initiate communication\nwith Threat Bus. See\n",(0,r.kt)("a",c({parentName:"p"},{href:"https://pypi.org/project/vast-threatbus/"}),"VAST Threat Bus")," for an example\napplication."))}w.isMDXComponent=!0}}]);